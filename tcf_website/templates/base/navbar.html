{% load static %}

{% block styles %}
<link rel="stylesheet" href="{% static 'base/navbar.css' %}" />
{% endblock %}

<header>
  <nav class="navbar navbar-expand-lg navbar-light fixed-top">

    <!-- tCF logo -->
    <a class="navbar-brand logo-container mx-auto" href="/">
      <img class="logo" src="{% static 'base/img/new_logo.svg' %}" alt="theCourseForum home">
    </a>

    <!-- tCF search -->
    {% include "search/searchbar.html" %}

    <!-- tCF navbar toggler -->
    <button class="navbar-toggler menu" id="menu-toggle" aria-label="Toggle menu">
      <span class="navbar-toggler-icon"></span>
    </button>

    <!-- tCF History Popup -->
    <div class="nav-item">
      <a class="nav-link d-flex align-items-center" href="#historyPage" data-toggle="modal">
        <i class="fa fa-clock" aria-hidden="true" style="width: 1.3em; height: 1.5em;"></i>
      </a>
    </div>

    <!-- tCF profile dropdown -->
    <div class="account-settings">
      {% if user.is_authenticated %}
        <div class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" data-toggle="dropdown">
            Hey, {{user.first_name}}!
          </a>
          <div class="dropdown-menu settings" aria-labelledby="navbarDropdown">
            <a class="dropdown-item" href="{% url 'profile' %}">My Profile</a>
            <a class="dropdown-item" href="{% url 'reviews' %}">My Reviews</a>
            <div class="dropdown-divider"></div>
            <a class="dropdown-item" href="{% url 'logout' %}">Logout</a>
          </div>
        </div>
        {% else %}
        <div class="nav-item">
          <a class="nav-link" href="#loginModal" data-toggle="modal">Sign In</a>
        </div>
      {% endif %}
    </div>
    
    <!-- Dark Mode Toggle -->
    <label class="theme-toggle" id="darkModeToggle" style="margin-bottom: 0;">
      <input type="checkbox" id="darkModeCheckbox" hidden>
      <div class="toggle-track">
        <span class="icon sun-icon" id="sunIcon">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 -960 960 960">
            <path d="M480-360q50 0 85-35t35-85-35-85-85-35-85 35-35 85 35 85 85 35m0 80q-83 0-141.5-58.5T280-480t58.5-141.5T480-680t141.5 58.5T680-480t-58.5 141.5T480-280M200-440H40v-80h160zm720 0H760v-80h160zM440-760v-160h80v160zm0 720v-160h80v160zM256-650l-101-97 57-59 96 100zm492 496-97-101 53-55 101 97zm-98-550 97-101 59 57-100 96zM154-212l101-97 55 53-97 101zm326-268"/>
          </svg>
        </span>
        <span class="icon moon-icon" id="moonIcon">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 -960 960 960">
            <path d="M480-120q-150 0-255-105T120-480t105-255 255-105q14 0 27.5 1t26.5 3q-41 29-65.5 75.5T444-660q0 90 63 153t153 63q55 0 101-24.5t75-65.5q2 13 3 26.5t1 27.5q0 150-105 255T480-120m0-80q88 0 158-48.5T740-375q-20 5-40 8t-40 3q-123 0-209.5-86.5T364-660q0-20 3-40t8-40q-78 32-126.5 102T200-480q0 116 82 198t198 82m-10-270"/>
          </svg>
        </span>
        <div class="toggle-thumb"></div>
      </div>
    </label>

    <!-- 
      OPTIONAL DARK MODE BUTTON IMPLEMENTATION
      Instead of a toggle switch, this implementation uses a single button to turn dark mode on/off.

      To use the button instead of the toggle:
      - Uncomment this section
      - Comment out or remove the toggle implementation
    -->
    <!-- <button id="darkModeToggle" class="dark-mode-toggle" aria-label="Toggle dark mode">
      <svg id="sunIcon" viewBox="0 0 24 24" width="1.3em" height="1.3em" fill="currentColor" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" xmlns="http://www.w3.org/2000/svg">
        <circle cx="12" cy="12" r="5"/>
        <line x1="12" y1="1" x2="12" y2="3"/>
        <line x1="12" y1="21" x2="12" y2="23"/>
        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/>
        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/>
        <line x1="1" y1="12" x2="3" y2="12"/>
        <line x1="21" y1="12" x2="23" y2="12"/>
        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/>
        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/>
      </svg>      
      <svg id="moonIcon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512" width="1.3em" height="1.3em" fill="currentColor"> -->
        <!--!Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc.-->
        <!-- <path d="M223.5 32C100 32 0 132.3 0 256S100 480 223.5 480c60.6 0 115.5-24.2 155.8-63.4c5-4.9 6.3-12.5 3.1-18.7s-10.1-9.7-17-8.5c-9.8 1.7-19.8 2.6-30.1 2.6c-96.9 0-175.5-78.8-175.5-176c0-65.8 36-123.1 89.3-153.3c6.1-3.5 9.2-10.5 7.7-17.3s-7.3-11.9-14.3-12.5c-6.3-.5-12.6-.8-19-.8z"/>
      </svg>
    </button>   -->

  </nav>
</header>

<script>
  // When the user clicks on <div>, open the popup
  function myFunction() {
    var popup = document.getElementById("myPopup");
    popup.classList.toggle("show");
  }

  (function () {
    const checkbox = document.getElementById('darkModeCheckbox');
    const body = document.body;

    // set initial mode from localStorage
    if (localStorage.getItem('dark-mode') === 'enabled') {
      body.classList.add('dark-mode');
      checkbox.checked = true;
    }

    checkbox.addEventListener('change', function () {
      if (checkbox.checked) {
        body.classList.add('dark-mode');
        localStorage.setItem('dark-mode', 'enabled');
      } else {
        body.classList.remove('dark-mode');
        localStorage.setItem('dark-mode', 'disabled');
      }
    });
  })();

  /* 
    OPTIONAL: JS for Dark Mode Button 
    If using the button instead of the toggle, uncomment the following:
  */
  // (function () {
  //   const toggleButton = document.getElementById('darkModeToggle');
  //   const sunIcon = document.getElementById('sunIcon');
  //   const moonIcon = document.getElementById('moonIcon');
  //   const body = document.body;

  //   function updateIcons() {
  //     const isDark = body.classList.contains('dark-mode');
  //     sunIcon.style.display = isDark ? 'none' : 'inline';
  //     moonIcon.style.display = isDark ? 'inline' : 'none';
  //   }

  //   // Initialize on load
  //   if (localStorage.getItem('dark-mode') === 'enabled') {
  //     body.classList.add('dark-mode');
  //   }
  //   updateIcons();

  //   // Toggle on click
  //   toggleButton.addEventListener('click', function () {
  //     body.classList.toggle('dark-mode');
  //     const isDark = body.classList.contains('dark-mode');
  //     localStorage.setItem('dark-mode', isDark ? 'enabled' : 'disabled');
  //     updateIcons();
  //   });
  // })();

</script>