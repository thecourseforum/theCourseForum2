{% extends "base/base.html" %}
{% load static %}

{% block title %}Browse - theCourseForum{% endblock %}

{% block styles %}
    <link rel="stylesheet" href="{% static 'browse/browse.css' %}"/>
{% endblock %}

{% block content %}
    {% comment %} <div class="container">
        {% include "../common/notification.html" %}
    </div> {% endcomment %}
    <div class="browse container">
        <!-- Banner(s) go here: -->
{#        {% include "../common/application_banner.html" %}#}
    
        {% include "../common/leaderboard_ad.html" with ad_slot="9691204298" %}

        <!-- Mode Toggle -->
        <div class="row mt-4 mb-3">
            <div class="col-12">
                <div class="mode-toggle-container">
                    <div class="mode-toggle-wrapper">
                        <a href="?mode=courses" class="mode-toggle-option {% if not is_club %}active{% endif %}">Courses</a>
                        <a href="?mode=clubs" class="mode-toggle-option {% if is_club %}active{% endif %}">Clubs</a>
                        <div class="mode-toggle-slider {% if is_club %}slide-right{% endif %}"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Browse page content -->
        {% if is_club %}
        <h2 class="font-weight-light mt-4">Browse by Category</h2>
        <div id="club-categories" class="schools text-left">
            {% if club_categories %}
                {% for category in club_categories %}
                    <div class="school card mb-3">
                        <div class="card-header pt-3" data-toggle="collapse"
                            data-target="#category-{{ category.id }}" aria-expanded="true"
                            id="header-{{ category.id }}">
                            <div class="float-left">
                                <h3 class="card-title mb-0 alignleft">
                                    <a href="{% url 'club_category' category.slug %}" class="text-white">{{ category.name }}</a>
                                </h3>
                            </div>
                            <div class="float-right">
                                <i class="fa fa-chevron-down-white" id="chevron-{{ category.id }}"></i>
                            </div>
                            <div class="clearfix"></div>
                        </div>
                        <div class="school-body collapse show" id="category-{{ category.id }}">
                            <ul class="department-list">
                                {% for club in category.clubs %}
                                <li>
                                    <a href="{% url 'course' mnemonic=category.slug course_number=club.id %}?mode=clubs">{{ club.name }}</a>
                                </li>
                                {% endfor %}
                            </ul>
                        </div>
                    </div>
                {% endfor %}
            {% else %}
                <p>No club categories available.</p>
            {% endif %}
        </div>
        {% else %}
        <h2 class="font-weight-light mt-4">Browse by Department</h2>
        <div class="schools text-left">
            {% include "browse/school.html" with school=CLAS %}
            {% include "browse/school.html" with school=SEAS %}
            {% for school in other_schools %}
                {% include "browse/school.html" with school=school %}
            {% endfor %}
        </div>
        {% endif %}
    </div>
{% endblock %}

{% block js %}
<script>
    document.addEventListener("DOMContentLoaded", function () {
        document.querySelectorAll(".card-header").forEach(header => {
            header.addEventListener("click", function () {
                let id = this.id.replace("header-", "").trim(); // Extract ID
                let collapseId = "collapse-" + id;
                let collapseElement = document.getElementById(collapseId);
                
                if (collapseElement) {
                    let isExpanded = collapseElement.classList.contains("show");
                    collapseElement.classList.toggle("show");
                    
                    let icon = document.getElementById(`chevron-${id}`); // Find the icon
                    if (icon) {
                        icon.classList.toggle("fa-chevron-down-white");
                        icon.classList.toggle("fa-chevron-up-white");
                    }
                }
            });
        });
    });    
</script>
{% endblock %}